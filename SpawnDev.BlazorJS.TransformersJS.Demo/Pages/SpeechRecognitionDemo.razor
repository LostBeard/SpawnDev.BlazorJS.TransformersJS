@page "/SpeechRecognition"

<div class="container">
    <h3>Speed Recognition</h3>
    <p>
        <a target="_blank" href="https://github.com/LostBeard/SpawnDev.BlazorJS.TransformersJS/blob/main/SpawnDev.BlazorJS.TransformersJS.Demo/Pages/SpeechRecognitionDemo.razor">Page *.razor source</a><br/>
        <a target="_blank" href="https://github.com/LostBeard/SpawnDev.BlazorJS.TransformersJS/blob/main/SpawnDev.BlazorJS.TransformersJS.Demo/Pages/SpeechRecognitionDemo.razor.cs">Page *.cs source</a>
    </p>
    <div style="padding: 0.5rem 0; display: flex; flex-direction: column; gap: 1rem; align-items: flex-start;">
        <div>
            <h4>Record audio</h4>
            <div style="padding: 0.3rem;">
                <AudioRecorder OnRecordingChanged="OnRecordingChanged" />
            </div>
            <h4>Or select an audio file</h4>
            <div style="padding: 0.3rem;background-color: var(--rz-body-background-color);border: 1px solid var(--rz-primary); border-radius: 0.5rem;">
                <input @ref=fileInputRef accept="audio/*" type="file" disabled="@(busy || !beenInit)" style="width: 100%;" />
            </div>

            <h4>Process</h4>
            <div style="padding: 0.3rem;">
                <audio src="@fileObjectUrl" controls style="@(string.IsNullOrEmpty(fileObjectUrl) ? "display: none;" : "")" />
            </div>
            <div>
                <RadzenStack Orientation="Orientation.Vertical" AlignItems="AlignItems.Normal" JustifyContent="JustifyContent.Left" Gap="0.5rem">
                    <RadzenLabel Text="Select an ONNX Model" Component="DropDownBindValue" />
                    <RadzenDropDown @bind-Value=@SelectedModel Data=@Models Style="width: 100%; max-width: 400px;" Name="DropDownBindValue" />
                </RadzenStack>
                <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Normal" JustifyContent="JustifyContent.Left" Gap="0.5rem" Style="padding: 1rem 0;">
                    <RadzenCheckBox @bind-Value=@UseWebGPU Name="WebGPUCheckBox" Disabled=true />
                    <RadzenLabel Text="WebGPU" Component="WebGPUCheckBox" class="rz-ms-2" />
                </RadzenStack>
            </div>
            <div style="padding: 0.5rem 0; max-width: 600px;">
                <ModelLoadView ModelProgresses="@ModelProgresses" />
            </div>
            <div>
                <button @onclick="RunIt" disabled="@(busy || !beenInit || string.IsNullOrEmpty(fileObjectUrl))">Run</button>
            </div>
        </div>
        <div style="@(PipelineResult == null ? "display: none;" :  "")">
            <h4>Result</h4>
            <pre>
                @PipelineResult?.Text
            </pre>
        </div>
    </div>
    <div style="padding: 0.5rem 0;">
        <h4>Status</h4>
        @((MarkupString)logMessage)
    </div>
</div>